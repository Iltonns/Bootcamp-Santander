"""Sistema de carrinho de compras em Python

## ‚ú® Funcionalidades

| √çcone | Funcionalidade | Descri√ß√£o |
|-------|---------------|-----------|
| ‚ûï | Adi√ß√£o de itens | Cadastra produtos com nome, pre√ßo unit√°rio e quantidade |
| ‚úñÔ∏è | Remo√ß√£o de itens | Remove produtos pelo nome (case insensitive) |
| üìã | Visualiza√ß√£o | Exibe lista formatada com subtotais e total geral |
| ÔøΩ | Valida√ß√£o | Verifica dados de entrada (pre√ßos positivos, quantidades inteiras) |
| üñ•Ô∏è | Interface | Menu interativo com limpeza autom√°tica de tela |
"""

import os

def limpar_tela():
    """Limpa a tela do console de acordo com o sistema operacional."""
    os.system("cls" if os.name == "nt" else "clear")

def imprimir_titulo(texto):
    """Imprime um t√≠tulo formatado com linhas de separa√ß√£o.
    
    Args:
        texto (str): O texto a ser exibido como t√≠tulo.
    """
    print("=" * 40)
    print(f"{texto:^40}")  # Centraliza o texto em 40 caracteres
    print("=" * 40)

def adicionar_item(carrinho):
    """Adiciona um item ao carrinho de compras.
    
    Solicita ao usu√°rio os detalhes do produto (nome, pre√ßo e quantidade),
    valida os dados e adiciona ao carrinho se estiverem corretos.
    
    Args:
        carrinho (list): Lista de dicion√°rios contendo os itens do carrinho.
    """
    while True:
        try:
            # Solicita os dados do produto em uma √∫nica linha
            linha = input("Digite o produto, pre√ßo e quantidade (ex: 'Arroz 10.50 2'): ").strip()
            if not linha:
                print("Entrada vazia. Tente novamente.")
                continue

            # Divide a entrada em partes (nome, pre√ßo, quantidade)
            partes = linha.rsplit(" ", 2)
            if len(partes) != 3:
                print("Formato inv√°lido. Use: nome pre√ßo quantidade")
                continue

            nome, preco_str, qtd_str = partes
            
            # Converte pre√ßo para float (suportando tanto '.' quanto ',' como separador decimal)
            preco = float(preco_str.replace(",", "."))
            quantidade = int(qtd_str)

            # Valida pre√ßo e quantidade
            if preco < 0 or quantidade <= 0:
                print("Pre√ßo deve ser positivo e quantidade maior que zero.")
                continue

            # Adiciona o produto ao carrinho como um dicion√°rio
            carrinho.append({"nome": nome, "preco": preco, "quantidade": quantidade})
            print(f"\n‚úÖ Produto '{nome}' adicionado com sucesso!")
            break
        except ValueError:
            print("‚ùå Pre√ßo ou quantidade inv√°lidos. Tente novamente.")

def remover_item(carrinho):
    """Remove um item do carrinho de compras.
    
    Solicita o nome do produto a ser removido e o remove do carrinho se encontrado.
    
    Args:
        carrinho (list): Lista de dicion√°rios contendo os itens do carrinho.
    """
    if not carrinho:
        print("‚ö†Ô∏è Carrinho vazio. Nada para remover.")
        return
    
    nome = input("Digite o nome do produto a remover: ").strip()
    
    # Procura o produto no carrinho (compara√ß√£o case-insensitive)
    for i, item in enumerate(carrinho):
        if item["nome"].lower() == nome.lower():
            carrinho.pop(i)  # Remove o item encontrado
            print(f"‚úÖ Produto '{nome}' removido do carrinho.")
            return
    
    print(f"‚ùå Produto '{nome}' n√£o encontrado no carrinho.")

def exibir_carrinho(carrinho):
    """Exibe o conte√∫do atual do carrinho de compras com formata√ß√£o.
    
    Mostra todos os itens, seus pre√ßos, quantidades e subtotais, al√©m do total geral.
    
    Args:
        carrinho (list): Lista de dicion√°rios contendo os itens do carrinho.
    """
    if not carrinho:
        print("üõí Seu carrinho est√° vazio!")
        return

    imprimir_titulo("Itens no Carrinho")
    total = 0.0
    
    # Exibe cada item com alinhamento formatado
    for item in carrinho:
        subtotal = item["preco"] * item["quantidade"]
        print(f"{item['nome']:<20} R${item['preco']:>6.2f} x {item['quantidade']:<3} = R${subtotal:>7.2f}")
        total += subtotal
    
    # Exibe o total geral
    print("-" * 40)
    print(f"{'TOTAL':<30} R${total:>7.2f}")
    print("=" * 40)

def main():
    """Fun√ß√£o principal que gerencia o fluxo do programa."""
    carrinho = []  # Inicializa o carrinho como uma lista vazia
    
    while True:
        imprimir_titulo("MENU PRINCIPAL")
        print("1 - Adicionar item")
        print("2 - Remover item")
        print("3 - Exibir carrinho")
        print("4 - Sair")
        
        escolha = input("Escolha uma op√ß√£o: ").strip()
        limpar_tela()

        if escolha == "1":
            imprimir_titulo("Adicionar Produto")
            adicionar_item(carrinho)
        elif escolha == "2":
            imprimir_titulo("Remover Produto")
            remover_item(carrinho)
        elif escolha == "3":
            exibir_carrinho(carrinho)
        elif escolha == "4":
            print("\n‚úÖ Saindo do sistema. Obrigado por usar o carrinho!")
            break
        else:
            print("‚ùå Op√ß√£o inv√°lida. Tente novamente.")

if __name__ == "__main__":
    main()
